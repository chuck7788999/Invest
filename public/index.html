<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>kt cloud 2026 ì‹ ì…ì‚¬ì› ë¹„ì¦ˆë‹ˆìŠ¤ ì•„í‚¤í…íŠ¸ ë°œí‘œíšŒ</title>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Noto Sans KR', sans-serif;
      background: linear-gradient(135deg, #0a0a1a 0%, #1a1a3a 50%, #0a0a2a 100%);
      min-height: 100vh;
      color: #fff;
      overflow: hidden;
    }

    /* íŒŒí‹°í´ ë°°ê²½ */
    #particles-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
    }

    .particle {
      position: absolute;
      background: linear-gradient(45deg, #ffd700, #ffaa00);
      border-radius: 50%;
      opacity: 0.6;
      animation: float 15s infinite ease-in-out;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-100px) rotate(180deg); }
    }

    /* ê´€ë¦¬ì ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
    .admin-panel {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      display: flex;
      flex-direction: column;
      gap: 10px;
      align-items: flex-end;
    }

    .admin-toggle {
      background: rgba(255, 215, 0, 0.9);
      color: #000;
      border: none;
      padding: 10px 20px;
      border-radius: 25px;
      font-weight: 700;
      cursor: pointer;
      font-size: 0.9rem;
    }

    .admin-controls {
      display: none;
      background: rgba(0, 0, 0, 0.9);
      border: 1px solid rgba(255, 215, 0, 0.3);
      border-radius: 15px;
      padding: 20px;
      width: 320px;
    }

    .admin-controls.show {
      display: block;
    }

    .admin-title {
      font-size: 1rem;
      font-weight: 700;
      color: #ffd700;
      margin-bottom: 15px;
      text-align: center;
    }

    .admin-section {
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .admin-section:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }

    .admin-label {
      font-size: 0.85rem;
      color: #888;
      margin-bottom: 8px;
    }

    .admin-status {
      font-size: 1.1rem;
      font-weight: 700;
      color: #ffd700;
    }

    .admin-btn {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 8px;
      font-weight: 700;
      cursor: pointer;
      margin-top: 8px;
      transition: all 0.2s;
    }

    .admin-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .admin-btn.primary {
      background: linear-gradient(135deg, #ffd700, #ff6b35);
      color: #000;
    }

    .admin-btn.secondary {
      background: #3498db;
      color: #fff;
    }

    .admin-btn.danger {
      background: #e74c3c;
      color: #fff;
    }

    .admin-btn.success {
      background: #27ae60;
      color: #fff;
    }

    /* ì¡° ì •ë³´ ìˆ˜ì • íŒ¨ë„ */
    .team-edit-item {
      margin-bottom: 8px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .team-name-input,
    .team-topic-input {
      width: 100%;
      padding: 8px;
      font-size: 0.8rem;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 6px;
      background: rgba(0, 0, 0, 0.3);
      color: #fff;
    }

    .team-name-input {
      font-weight: 700;
    }

    .team-topic-input {
      font-size: 0.75rem;
    }

    /* ë°œí‘œ ìˆœì„œ ì„¤ì • */
    .presentation-order-display {
      background: rgba(255, 215, 0, 0.1);
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 0.85rem;
      color: #ffd700;
      margin-bottom: 8px;
      text-align: center;
    }

    .order-edit-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 6px;
    }

    .order-edit-row span {
      font-size: 0.8rem;
      color: #aaa;
      min-width: 50px;
    }

    .order-select {
      flex: 1;
      padding: 6px 10px;
      font-size: 0.85rem;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 6px;
      background: rgba(0, 0, 0, 0.3);
      color: #fff;
    }

    .admin-divider {
      border: none;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      margin: 15px 0;
    }

    .edit-panel-hidden {
      display: none;
      margin-top: 10px;
    }

    .edit-panel-save-btn {
      margin-top: 10px;
    }

    .step-info {
      text-align: center;
      padding: 10px;
      background: rgba(255, 215, 0, 0.1);
      border-radius: 8px;
      margin-bottom: 10px;
    }

    .step-number {
      font-size: 2rem;
      font-weight: 900;
      color: #ffd700;
    }

    .step-desc {
      font-size: 0.85rem;
      color: #aaa;
    }

    .keyboard-hint {
      text-align: center;
      font-size: 0.75rem;
      color: #666;
      margin-top: 10px;
    }

    .keyboard-hint kbd {
      background: rgba(255, 255, 255, 0.1);
      padding: 2px 8px;
      border-radius: 4px;
      margin: 0 2px;
    }

    /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
    .main-container {
      position: relative;
      z-index: 1;
      padding: 40px;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* í—¤ë” */
    .header {
      text-align: center;
      margin-bottom: 30px;
      transition: margin-bottom 0.3s ease;
    }

    .logo {
      font-size: 1.2rem;
      color: #ff6b35;
      font-weight: 700;
      letter-spacing: 3px;
      margin-bottom: 10px;
    }

    .title {
      font-size: 3rem;
      font-weight: 900;
      background: linear-gradient(90deg, #ffd700, #ff6b35, #ffd700);
      background-size: 200% auto;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: shimmer 3s linear infinite;
    }

    @keyframes shimmer {
      0% { background-position: 0% center; }
      100% { background-position: 200% center; }
    }

    .subtitle {
      font-size: 1.5rem;
      color: #888;
      margin-top: 10px;
    }

    /* ê²°ê³¼ í™”ë©´ì—ì„œ subtitle ìˆ¨ê¸°ê¸° */
    #results-screen:not([style*="display: none"]) ~ .header .subtitle,
    .main-container:has(#results-screen:not([style*="display: none"])) .header .subtitle {
      display: none;
    }

    /* Phase 1: ëŒ€ê¸° í™”ë©´ */
    #waiting-screen {
      flex: 1;
      display: flex;
      gap: 40px;
    }

    .teams-panel {
      flex: 1;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }

    .team-card {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      padding: 30px;
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
    }

    .team-card:hover {
      transform: translateY(-5px);
      border-color: rgba(255, 215, 0, 0.3);
      box-shadow: 0 10px 40px rgba(255, 215, 0, 0.1);
    }

    .team-number {
      display: inline-block;
      background: linear-gradient(135deg, #ffd700, #ff6b35);
      color: #000;
      padding: 8px 20px;
      border-radius: 30px;
      font-weight: 700;
      font-size: 1.1rem;
      margin-bottom: 15px;
    }

    .team-topic {
      font-size: 1.4rem;
      font-weight: 500;
      line-height: 1.4;
      color: #fff;
    }

    .qr-panel {
      width: 400px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      padding: 30px;
      display: flex;
      flex-direction: column;
      align-items: center;
      backdrop-filter: blur(10px);
    }

    .qr-title {
      font-size: 1.3rem;
      font-weight: 700;
      margin-bottom: 20px;
      color: #ffd700;
    }

    #qr-code {
      background: #fff;
      padding: 20px;
      border-radius: 15px;
      margin-bottom: 20px;
    }

    .qr-instruction {
      text-align: center;
      color: #888;
      font-size: 1rem;
      line-height: 1.6;
    }

    /* ì ‘ì† í˜„í™© */
    .connection-status {
      margin-top: 30px;
      padding: 20px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 15px;
      width: 100%;
    }

    .connection-title {
      font-size: 1rem;
      color: #888;
      margin-bottom: 10px;
    }

    .connection-count {
      font-size: 2.5rem;
      font-weight: 900;
      color: #ffd700;
    }

    .connection-list {
      margin-top: 15px;
      max-height: 150px;
      overflow-y: auto;
    }

    .connection-item {
      display: inline-block;
      background: rgba(255, 215, 0, 0.2);
      padding: 5px 12px;
      border-radius: 20px;
      margin: 3px;
      font-size: 0.9rem;
      animation: popIn 0.3s ease;
    }

    @keyframes popIn {
      0% { transform: scale(0); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }

    /* Phase 1: í‰ê°€ ì§„í–‰ í™”ë©´ */
    #evaluation-screen {
      display: none;
      flex: 1;
      flex-direction: column;
    }

    .progress-section {
      text-align: center;
      padding: 40px;
    }

    .progress-title {
      font-size: 2rem;
      margin-bottom: 30px;
      color: #ffd700;
    }

    .progress-bar-container {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 30px;
      height: 40px;
      width: 80%;
      margin: 0 auto;
      overflow: hidden;
      position: relative;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #ffd700, #ff6b35);
      border-radius: 30px;
      transition: width 0.5s ease;
      position: relative;
    }

    .progress-bar::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      animation: progressShine 2s infinite;
    }

    @keyframes progressShine {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    .progress-text {
      font-size: 3rem;
      font-weight: 900;
      margin-top: 30px;
    }

    .progress-detail {
      font-size: 1.2rem;
      color: #888;
      margin-top: 10px;
    }

    .start-presentation-btn {
      display: none;
      margin-top: 30px;
      padding: 20px 50px;
      font-size: 1.5rem;
      font-weight: 700;
      color: #000;
      background: linear-gradient(135deg, #ffd700, #ff6b35);
      border: none;
      border-radius: 50px;
      cursor: pointer;
      box-shadow: 0 5px 30px rgba(255, 215, 0, 0.4);
      transition: all 0.3s ease;
      animation: pulseButton 2s infinite;
    }

    .start-presentation-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 10px 40px rgba(255, 215, 0, 0.6);
    }

    .start-presentation-btn.show {
      display: inline-block;
    }

    @keyframes pulseButton {
      0%, 100% { box-shadow: 0 5px 30px rgba(255, 215, 0, 0.4); }
      50% { box-shadow: 0 5px 50px rgba(255, 215, 0, 0.8); }
    }

    .evaluation-teams {
      flex: 1;
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      padding: 20px 40px;
    }

    .eval-team-card {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 25px;
      text-align: center;
    }

    .eval-team-name {
      font-size: 1.5rem;
      font-weight: 700;
      color: #ffd700;
      margin-bottom: 10px;
    }

    .eval-team-topic {
      font-size: 1rem;
      color: #aaa;
      line-height: 1.4;
    }

    /* Phase 2: ê²°ê³¼ ë°œí‘œ í™”ë©´ */
    #results-screen {
      display: none;
      flex: 1;
      position: relative;
      flex-direction: row;
    }

    /* ë™ì „ ë¹„ íš¨ê³¼ */
    #coin-rain {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 50;
      display: none;
    }

    .coin {
      position: absolute;
      font-size: 2rem;
      animation: coinFall 3s linear forwards;
    }

    @keyframes coinFall {
      0% { transform: translateY(-50px) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }

    /* ìˆœìœ„ ë°œí‘œ - ì½”ì¸ ìŠ¤íƒœí‚¹ */
    .rank-container {
      display: flex;
      justify-content: center;
      align-items: flex-end;
      min-height: 0;
      max-height: calc(100vh - 200px);
      padding: 20px 40px 40px 40px;
      gap: 60px;
      flex: 1;
      position: relative;
      overflow: hidden;
    }

    .coin-stack-wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-end;
      width: 180px;
      position: relative;
      height: auto;
    }

    .rank-info {
      text-align: center;
      opacity: 0;
      transition: all 0.5s ease;
      z-index: 10;
      white-space: nowrap;
      margin-bottom: 25px;
      position: relative;
    }

    .rank-info.visible {
      opacity: 1;
    }

    .rank-position {
      font-size: 3rem;
      font-weight: 900;
      color: #ffd700;
    }

    .rank-team-name {
      font-size: 1.5rem;
      font-weight: 700;
      margin: 10px 0;
    }

    .rank-amount {
      font-size: 2rem;
      font-weight: 700;
      color: #ff6b35;
    }

    /* ì½”ì¸ ìŠ¤íƒ ì˜ì—­ */
    .coin-stack-area {
      width: 160px;
      height: 450px;
      position: relative;
      cursor: pointer;
      border-radius: 10px;
      transition: all 0.3s ease;
    }

    .coin-stack-area.highlighted {
      filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.8));
    }

    .coin-stack-area.dimmed {
      opacity: 0.3;
      filter: grayscale(70%);
    }

    /* ì½”ì¸ ìŠ¤íƒ ë² ì´ìŠ¤ (ë°”ë‹¥ glow) */
    .stack-base {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 140px;
      height: 20px;
      background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.5), transparent);
      border-radius: 50%;
      box-shadow: 0 0 30px 10px rgba(255, 215, 0, 0.3);
    }

    /* ì½”ì¸ ìŠ¤íƒ ì»¨í…Œì´ë„ˆ */
    .coin-stack {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      width: 120px;
      display: flex;
      flex-direction: column-reverse;
      align-items: center;
    }

    /* ê°œë³„ ì½”ì¸ ë ˆì´ì–´ */
    .coin-layer {
      width: 120px;
      height: 8px;
      background: linear-gradient(180deg, #FFD700 0%, #DAA520 50%, #B8860B 100%);
      border-radius: 60px / 4px;
      position: relative;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      margin-top: -2px;
    }

    .coin-layer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 10%;
      width: 80%;
      height: 2px;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
      border-radius: 50%;
    }

    .rank-info.revealed {
      opacity: 1;
    }

    @keyframes coinDrop {
      0% {
        transform: translateY(-100px) rotate(0deg);
        opacity: 0;
      }
      20% {
        opacity: 1;
      }
      100% {
        transform: translateY(0) rotate(720deg);
        opacity: 1;
      }
    }

    /* ì½”ì¸ ìº”ë²„ìŠ¤ */
    #coin-canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 15;
    }

    /* ê²°ê³¼ í™”ë©´ ë ˆì´ì•„ì›ƒ ì¡°ì • */
    #results-screen {
      position: relative;
      background: linear-gradient(180deg, #0a0a1a 0%, #0d1528 50%, #0a1520 100%);
    }

    /* í”¼ë“œë°± íŒì—… ì˜¤ë²„ë ˆì´ */
    .feedback-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }

    .feedback-overlay.show {
      display: flex;
    }

    /* í”¼ë“œë°± íŒì—… íŒ¨ë„ */
    .feedback-panel {
      display: none;
      width: 500px;
      max-width: 90vw;
      max-height: 70vh;
      background: linear-gradient(180deg, rgba(30, 30, 60, 0.98) 0%, rgba(20, 20, 40, 0.98) 100%);
      border: 2px solid rgba(255, 215, 0, 0.4);
      border-radius: 20px;
      padding: 0;
      overflow: hidden;
      animation: popupIn 0.3s ease;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5), 0 0 30px rgba(255, 215, 0, 0.2);
      cursor: pointer;
    }

    .feedback-panel.show {
      display: flex;
      flex-direction: column;
    }

    .feedback-panel-content {
      padding: 30px;
      overflow-y: auto;
      height: 100%;
      cursor: default;
    }

    @keyframes popupIn {
      0% { opacity: 0; transform: scale(0.9); }
      100% { opacity: 1; transform: scale(1); }
    }

    .feedback-header {
      text-align: center;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 1px solid rgba(255, 215, 0, 0.2);
    }

    .feedback-team {
      font-size: 1.8rem;
      font-weight: 700;
      color: #ffd700;
    }

    .feedback-amount {
      font-size: 1.3rem;
      color: #ff6b35;
      margin-top: 10px;
    }

    .feedback-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
      flex: 1;
      overflow-y: auto;
    }

    .feedback-item {
      background: rgba(255, 255, 255, 0.05);
      padding: 15px 20px;
      border-radius: 10px;
      border-left: 4px solid #ffd700;
    }

    .feedback-author {
      font-size: 0.9rem;
      color: #888;
      margin-bottom: 5px;
    }

    .feedback-content {
      font-size: 1.1rem;
      line-height: 1.5;
    }

    .feedback-close {
      position: absolute;
      top: 15px;
      right: 15px;
      width: 40px;
      height: 40px;
      background: rgba(255, 255, 255, 0.1);
      border: none;
      border-radius: 50%;
      color: #fff;
      font-size: 24px;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .feedback-close:hover {
      background: rgba(255, 100, 100, 0.3);
      transform: scale(1.1);
    }

    /* ë°ë“œíˆíŠ¸ íš¨ê³¼ */
    .deadheat-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 150;
      justify-content: center;
      align-items: center;
    }

    .deadheat-content {
      text-align: center;
    }

    .deadheat-text {
      font-size: 5rem;
      font-weight: 900;
      color: #ffd700;
      text-shadow: 0 0 50px rgba(255, 215, 0, 0.8);
      animation: deadheatPulse 0.5s infinite alternate;
    }

    .deadheat-amount {
      font-size: 3rem;
      font-weight: 700;
      color: #ff6b35;
      margin-top: 20px;
    }

    .deadheat-teams {
      font-size: 2.5rem;
      font-weight: 700;
      color: #fff;
      margin-top: 30px;
    }

    .deadheat-vs {
      color: #ffd700;
      margin: 0 20px;
    }

    @keyframes deadheatPulse {
      0% { transform: scale(1); }
      100% { transform: scale(1.1); }
    }

    /* ìµœì¢… ê²°ê³¼ í™”ë©´ */
    .final-result {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0a0a1a 0%, #1a1a3a 50%, #0a0a2a 100%);
      z-index: 200;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }

    .winner-crown {
      font-size: 8rem;
      margin-bottom: 20px;
      animation: crownBounce 1s infinite;
    }

    @keyframes crownBounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }

    .winner-title {
      font-size: 2rem;
      color: #888;
      margin-bottom: 10px;
    }

    .winner-name {
      font-size: 5rem;
      font-weight: 900;
      background: linear-gradient(90deg, #ffd700, #ff6b35, #ffd700);
      background-size: 200% auto;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: shimmer 2s linear infinite;
    }

    .winner-amount {
      font-size: 3rem;
      color: #ffd700;
      margin-top: 20px;
    }

    .winner-diff {
      font-size: 1.5rem;
      color: #888;
      margin-top: 10px;
    }

    .winner-investment-details {
      margin-top: 30px;
      padding: 20px 40px;
      background: rgba(255, 215, 0, 0.1);
      border-radius: 15px;
      border: 1px solid rgba(255, 215, 0, 0.3);
      max-width: 800px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .winner-investment-details:hover {
      background: rgba(255, 215, 0, 0.2);
      border-color: rgba(255, 215, 0, 0.5);
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(255, 215, 0, 0.3);
    }

    .winner-investment-details:active {
      transform: translateY(0);
    }

    .winner-investment-title {
      font-size: 1.3rem;
      color: #ffd700;
      margin-bottom: 15px;
      font-weight: 700;
    }

    .winner-investment-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .winner-investment-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 15px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
    }

    .winner-investment-item .investor-name {
      font-size: 1rem;
      color: #fff;
      font-weight: 500;
    }

    .winner-investment-item .investment-amount {
      font-size: 1.1rem;
      color: #ffd700;
      font-weight: 700;
    }

    .winner-feedback {
      margin-top: 40px;
      max-width: 1000px;
      text-align: center;
      padding: 0 40px;
    }

    .winner-feedback-title {
      font-size: 1.5rem;
      color: #ffd700;
      margin-bottom: 20px;
    }

    .winner-feedback-list {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
      max-height: 400px;
      overflow-y: auto;
      padding: 10px;
    }

    .winner-feedback-item {
      background: rgba(255, 255, 255, 0.05);
      padding: 15px 25px;
      border-radius: 10px;
      max-width: 400px;
      border-left: 4px solid #ffd700;
    }

    .winner-feedback-item .feedback-author {
      font-size: 0.9rem;
      color: #888;
      margin-bottom: 8px;
      font-weight: 700;
    }

    .winner-feedback-item .feedback-content {
      font-size: 1rem;
      line-height: 1.6;
      color: #fff;
    }

    /* ë§ˆì§€ë§‰ ì¶•í•˜ í˜ì´ì§€ */
    .closing-screen {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0a0a1a 0%, #1a1a3a 50%, #0a0a2a 100%);
      z-index: 300;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }

    .closing-screen.show {
      display: flex;
    }

    .closing-content {
      text-align: center;
      animation: fadeInUp 0.8s ease;
    }

    @keyframes fadeInUp {
      0% {
        opacity: 0;
        transform: translateY(30px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .closing-icon {
      font-size: 6rem;
      margin-bottom: 30px;
      animation: bounce 2s infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }

    .closing-message {
      font-size: 3.5rem;
      font-weight: 900;
      background: linear-gradient(90deg, #ffd700, #ff6b35, #ffd700);
      background-size: 200% auto;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: shimmer 2s linear infinite;
      margin-bottom: 20px;
      line-height: 1.4;
    }

    .closing-subtitle {
      font-size: 1.5rem;
      color: #888;
      margin-top: 30px;
    }

    /* ì ‘ì† ì•Œë¦¼ í† ìŠ¤íŠ¸ */
    .toast-container {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 300;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .toast {
      background: rgba(255, 215, 0, 0.9);
      color: #000;
      padding: 15px 30px;
      border-radius: 30px;
      font-weight: 700;
      animation: toastIn 0.3s ease, toastOut 0.3s ease 2.7s forwards;
    }

    @keyframes toastIn {
      0% { transform: translateY(50px); opacity: 0; }
      100% { transform: translateY(0); opacity: 1; }
    }

    @keyframes toastOut {
      0% { transform: translateY(0); opacity: 1; }
      100% { transform: translateY(-50px); opacity: 0; }
    }
  </style>
</head>
<body>
  <!-- íŒŒí‹°í´ ë°°ê²½ -->
  <div id="particles-container"></div>

  <!-- ë™ì „ ë¹„ íš¨ê³¼ -->
  <div id="coin-rain"></div>

  <!-- ê´€ë¦¬ì ì»¨íŠ¸ë¡¤ íŒ¨ë„ -->
  <div class="admin-panel">
    <button class="admin-toggle" onclick="toggleAdmin()">âš™ï¸ MC ì»¨íŠ¸ë¡¤</button>
    <div class="admin-controls" id="admin-controls">
      <div class="admin-title">ğŸ¤ MC ì»¨íŠ¸ë¡¤ íŒ¨ë„</div>

      <div class="admin-section">
        <div class="admin-label">í˜„ì¬ ìƒíƒœ</div>
        <div class="admin-status" id="admin-phase">ëŒ€ê¸° ì¤‘</div>
      </div>

      <div class="admin-section" id="step-section" style="display:none;">
        <div class="step-info">
          <div class="step-number" id="current-step">1</div>
          <div class="step-desc" id="step-desc">ì˜¤í”„ë‹</div>
        </div>
      </div>

      <div class="admin-section">
        <div class="admin-label">ì ‘ì†/í‰ê°€ í˜„í™©</div>
        <div class="admin-status"><span id="admin-connected">0</span>ëª… ì ‘ì† / <span id="admin-evaluated">0</span>ëª… ì™„ë£Œ</div>
      </div>

      <div class="admin-section" id="waiting-controls">
        <button class="admin-btn success" onclick="startEvaluation()">â–¶ï¸ í‰ê°€ ì‹œì‘</button>
        <button class="admin-btn secondary" onclick="addDemoEvaluators()">ğŸ§ª ë°ëª¨ í‰ê°€ì ì¶”ê°€</button>
      </div>

      <div class="admin-section" id="eval-controls" style="display:none;">
        <button class="admin-btn primary" onclick="addDemoEvaluation()">ğŸ“ ë°ëª¨ í‰ê°€ ì¶”ê°€</button>
        <button class="admin-btn danger" onclick="forceClose()">âš ï¸ ê°•ì œ ë§ˆê°</button>
      </div>

      <div class="admin-section" id="results-controls" style="display:none;">
        <button class="admin-btn primary" onclick="startPresentation()">ğŸ¬ ê²°ê³¼ ë°œí‘œ ì‹œì‘</button>
      </div>

      <div class="admin-section" id="presentation-controls" style="display:none;">
        <button class="admin-btn primary" id="next-btn" onclick="nextStep()">â¡ï¸ ë‹¤ìŒ ë‹¨ê³„</button>
        <div class="keyboard-hint">
          <kbd>Space</kbd> ë˜ëŠ” <kbd>â†’</kbd> í‚¤ë¡œ ì§„í–‰
        </div>
      </div>

      <div class="admin-section">
        <button class="admin-btn danger" onclick="resetSystem()">ğŸ”„ ì „ì²´ ë¦¬ì…‹</button>
      </div>

      <hr class="admin-divider">

      <!-- ì¡° ì •ë³´ ìˆ˜ì • -->
      <div class="admin-section">
        <div class="admin-label">ğŸ“ ì¡° ì •ë³´ ìˆ˜ì •</div>
        <button class="admin-btn secondary" onclick="toggleTeamEdit()">ì¡° ì´ë¦„/í† í”½ ìˆ˜ì •</button>
        <div id="team-edit-panel" class="edit-panel-hidden">
          <div class="team-edit-item" data-team-id="1">
            <input type="text" class="team-name-input" id="team-name-1" placeholder="1ì¡° ì´ë¦„">
            <input type="text" class="team-topic-input" id="team-topic-1" placeholder="1ì¡° í† í”½">
          </div>
          <div class="team-edit-item" data-team-id="2">
            <input type="text" class="team-name-input" id="team-name-2" placeholder="2ì¡° ì´ë¦„">
            <input type="text" class="team-topic-input" id="team-topic-2" placeholder="2ì¡° í† í”½">
          </div>
          <div class="team-edit-item" data-team-id="3">
            <input type="text" class="team-name-input" id="team-name-3" placeholder="3ì¡° ì´ë¦„">
            <input type="text" class="team-topic-input" id="team-topic-3" placeholder="3ì¡° í† í”½">
          </div>
          <div class="team-edit-item" data-team-id="4">
            <input type="text" class="team-name-input" id="team-name-4" placeholder="4ì¡° ì´ë¦„">
            <input type="text" class="team-topic-input" id="team-topic-4" placeholder="4ì¡° í† í”½">
          </div>
          <button type="button" class="admin-btn success edit-panel-save-btn" onclick="saveTeamInfo()">ğŸ’¾ ì €ì¥</button>
        </div>
      </div>

      <!-- ë°œí‘œ ìˆœì„œ ìˆ˜ì • -->
      <div class="admin-section">
        <div class="admin-label">ğŸ”¢ ë°œí‘œ ìˆœì„œ ì„¤ì •</div>
        <div class="presentation-order-display" id="presentation-order-display">2ì¡° â†’ 4ì¡° â†’ 3ì¡° â†’ 1ì¡°</div>
        <button class="admin-btn secondary" onclick="toggleOrderEdit()">ìˆœì„œ ë³€ê²½</button>
        <div id="order-edit-panel" class="edit-panel-hidden">
          <div class="order-edit-row">
            <span>1ë²ˆì§¸:</span>
            <select id="order-1" class="order-select">
              <option value="1">1ì¡°</option>
              <option value="2" selected>2ì¡°</option>
              <option value="3">3ì¡°</option>
              <option value="4">4ì¡°</option>
            </select>
          </div>
          <div class="order-edit-row">
            <span>2ë²ˆì§¸:</span>
            <select id="order-2" class="order-select">
              <option value="1">1ì¡°</option>
              <option value="2">2ì¡°</option>
              <option value="3">3ì¡°</option>
              <option value="4" selected>4ì¡°</option>
            </select>
          </div>
          <div class="order-edit-row">
            <span>3ë²ˆì§¸:</span>
            <select id="order-3" class="order-select">
              <option value="1">1ì¡°</option>
              <option value="2">2ì¡°</option>
              <option value="3" selected>3ì¡°</option>
              <option value="4">4ì¡°</option>
            </select>
          </div>
          <div class="order-edit-row">
            <span>4ë²ˆì§¸:</span>
            <select id="order-4" class="order-select">
              <option value="1" selected>1ì¡°</option>
              <option value="2">2ì¡°</option>
              <option value="3">3ì¡°</option>
              <option value="4">4ì¡°</option>
            </select>
          </div>
          <button type="button" class="admin-btn success edit-panel-save-btn" onclick="saveOrder()">ğŸ’¾ ìˆœì„œ ì €ì¥</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
  <div class="main-container">
    <!-- í—¤ë” -->
    <header class="header">
      <div class="logo">kt cloud 2026</div>
      <h1 class="title">ì‹ ì…ì‚¬ì› ë¹„ì¦ˆë‹ˆìŠ¤ ì•„í‚¤í…íŠ¸ ë°œí‘œíšŒ</h1>
      <p class="subtitle">íˆ¬ì ìœ ì¹˜ ê²½ìŸ - ë‹¹ì‹ ì˜ ì„ íƒì´ ë¯¸ë˜ë¥¼ ê²°ì •í•©ë‹ˆë‹¤</p>
    </header>

    <!-- Phase 1: ëŒ€ê¸° í™”ë©´ -->
    <div id="waiting-screen">
      <div class="teams-panel" id="teams-panel"></div>

      <div class="qr-panel">
        <h2 class="qr-title">ğŸ“± í‰ê°€ì ì ‘ì†</h2>
        <div id="qr-code"></div>
        <p class="qr-instruction">
          QR ì½”ë“œë¥¼ ìŠ¤ìº”í•˜ì—¬<br>
          í‰ê°€ì— ì°¸ì—¬í•´ì£¼ì„¸ìš”
        </p>

        <div class="connection-status">
          <div class="connection-title">ì ‘ì† í˜„í™©</div>
          <div class="connection-count"><span id="connected-count">0</span>ëª… ì ‘ì†</div>
          <div class="connection-list" id="connection-list"></div>
        </div>
      </div>
    </div>

    <!-- Phase 1: í‰ê°€ ì§„í–‰ í™”ë©´ -->
    <div id="evaluation-screen">
      <div class="progress-section">
        <h2 class="progress-title">ğŸ”¥ ì‹¤ì‹œê°„ í‰ê°€ ì§„í–‰ ì¤‘</h2>
        <div class="progress-bar-container">
          <div class="progress-bar" id="progress-bar" style="width: 0%"></div>
        </div>
        <div class="progress-text">
          <span id="eval-count">0</span> / <span id="total-evaluators">12</span>
        </div>
        <div class="progress-detail" id="progress-detail">í‰ê°€ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...</div>
        <button class="start-presentation-btn" id="start-presentation-btn" onclick="startPresentation()">ğŸ¬ ë°œí‘œ ì‹œì‘</button>
      </div>

      <div class="evaluation-teams" id="evaluation-teams"></div>
    </div>

    <!-- Phase 2: ê²°ê³¼ ë°œí‘œ í™”ë©´ -->
    <div id="results-screen">
      <canvas id="coin-canvas"></canvas>
      <div class="rank-container" id="rank-container"></div>
    </div>
  </div>

  <!-- í”¼ë“œë°± íŒì—… ì˜¤ë²„ë ˆì´ -->
  <div class="feedback-overlay" id="feedback-overlay" onclick="hideFeedbackPanel(event)">
    <div class="feedback-panel" id="feedback-panel" onclick="hideFeedbackPanel(event)">
      <div class="feedback-panel-content" onclick="event.stopPropagation()">
        <button class="feedback-close" onclick="hideFeedbackPanel()">&times;</button>
        <div class="feedback-header">
          <div class="feedback-team" id="popup-team-name"></div>
          <div class="feedback-amount" id="popup-amount"></div>
        </div>
        <div class="feedback-list" id="feedback-list"></div>
      </div>
    </div>
  </div>

  <!-- ë°ë“œíˆíŠ¸ ì˜¤ë²„ë ˆì´ -->
  <div class="deadheat-overlay" id="deadheat-overlay">
    <div class="deadheat-content">
      <div class="deadheat-text">ğŸ”¥ ë™ì ! ğŸ”¥</div>
      <div class="deadheat-amount" id="deadheat-amount"></div>
      <div class="deadheat-teams">
        <span id="deadheat-team1"></span>
        <span class="deadheat-vs">VS</span>
        <span id="deadheat-team2"></span>
      </div>
    </div>
  </div>

  <!-- ìµœì¢… ê²°ê³¼ í™”ë©´ -->
  <div class="final-result" id="final-result">
    <div class="winner-crown">ğŸ‘‘</div>
    <div class="winner-title">ìµœì¢… íˆ¬ì ìœ ì¹˜ 1ìœ„</div>
    <div class="winner-name" id="winner-name"></div>
    <div class="winner-amount" id="winner-amount"></div>
    <div class="winner-diff" id="winner-diff"></div>
    <div class="winner-investment-details" id="winner-investment-details" onclick="showClosingScreen()"></div>
    <div class="winner-feedback">
      <div class="winner-feedback-title">ğŸ’¬ ì„ì›ì§„ í”¼ë“œë°±</div>
      <div class="winner-feedback-list" id="winner-feedback-list"></div>
    </div>
  </div>

  <!-- ë§ˆì§€ë§‰ ì¶•í•˜ í˜ì´ì§€ -->
  <div class="closing-screen" id="closing-screen">
    <div class="closing-content">
      <div class="closing-icon">ğŸ‰</div>
      <div class="closing-message">ì‹ ì…ì‚¬ì› ì…ë¬¸êµìœ¡<br>ëª¨ë‘ ê³ ìƒí–ˆìŠµë‹ˆë‹¤.</div>
      <div class="closing-subtitle">ê°ì‚¬í•©ë‹ˆë‹¤</div>
    </div>
  </div>

  <!-- í† ìŠ¤íŠ¸ ì»¨í…Œì´ë„ˆ -->
  <div class="toast-container" id="toast-container"></div>

  <script>
    // ============ ìƒíƒœ ê´€ë¦¬ ============
    const socket = io();
    let currentState = null;
    let rankedTeams = [];
    let presentationStep = 0;

    const stepDescriptions = {
      0: 'ì¤€ë¹„ ì¤‘',
      1: 'ğŸ‰ ì˜¤í”„ë‹',
      2: '4ï¸âƒ£ 4ìœ„ ë°œí‘œ',
      3: '3ï¸âƒ£ 3ìœ„ ë°œí‘œ',
      4: 'ğŸ”¥ 1/2ìœ„ ë°ë“œíˆíŠ¸',
      5: 'ğŸ“Š 1/2ìœ„ ì ìˆ˜ ê³µê°œ',
      6: 'ğŸ‘‘ 1ìœ„ í•˜ì´ë¼ì´íŠ¸',
      7: 'ğŸ† ìµœì¢… ê²°ê³¼'
    };

    // ============ ê´€ë¦¬ì íŒ¨ë„ ============
    function toggleAdmin() {
      document.getElementById('admin-controls').classList.toggle('show');
    }

    function updateAdminUI() {
      if (!currentState) return;

      document.getElementById('admin-connected').textContent = currentState.connectedCount;
      document.getElementById('admin-evaluated').textContent = currentState.evaluatedCount;

      // Phaseë³„ ìƒíƒœ í‘œì‹œ
      const phaseNames = {
        'waiting': 'ëŒ€ê¸° ì¤‘',
        'evaluating': 'í‰ê°€ ì§„í–‰ ì¤‘',
        'results': 'ì§‘ê³„ ì™„ë£Œ',
        'presenting': 'ê²°ê³¼ ë°œí‘œ ì¤‘'
      };
      document.getElementById('admin-phase').textContent = phaseNames[currentState.phase] || currentState.phase;

      // ì»¨íŠ¸ë¡¤ ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¹€
      document.getElementById('waiting-controls').style.display = currentState.phase === 'waiting' ? 'block' : 'none';
      document.getElementById('eval-controls').style.display = currentState.phase === 'evaluating' ? 'block' : 'none';
      document.getElementById('results-controls').style.display = currentState.phase === 'results' ? 'block' : 'none';
      document.getElementById('presentation-controls').style.display = currentState.phase === 'presenting' ? 'block' : 'none';
      document.getElementById('step-section').style.display = currentState.phase === 'presenting' ? 'block' : 'none';

      if (currentState.phase === 'presenting') {
        document.getElementById('current-step').textContent = presentationStep;
        document.getElementById('step-desc').textContent = stepDescriptions[presentationStep];
        document.getElementById('next-btn').disabled = presentationStep >= 5;
      }
    }

    // ============ ê´€ë¦¬ì ì•¡ì…˜ ============
    function startEvaluation() {
      socket.emit('admin:startEvaluation');
      showToast('í‰ê°€ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤!');
    }

    function forceClose() {
      socket.emit('admin:forceClose');
      showToast('í‰ê°€ê°€ ê°•ì œ ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤');
    }

    function startPresentation() {
      socket.emit('admin:startPresentation');
    }

    function nextStep() {
      socket.emit('admin:nextStep');
    }

    function resetSystem() {
      if (confirm('ì „ì²´ ì‹œìŠ¤í…œì„ ë¦¬ì…‹í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        socket.emit('admin:reset');
      }
    }

    // ============ ì¡° ì •ë³´ ìˆ˜ì • ============
    function toggleTeamEdit() {
      const panel = document.getElementById('team-edit-panel');
      if (panel.style.display === 'none' || panel.style.display === '') {
        panel.style.display = 'block';
        // í˜„ì¬ ë°ì´í„° ë¡œë“œ
        if (currentState && currentState.teams) {
          currentState.teams.forEach(team => {
            document.getElementById(`team-name-${team.id}`).value = team.name;
            document.getElementById(`team-topic-${team.id}`).value = team.topic;
          });
        }
      } else {
        panel.style.display = 'none';
      }
    }

    function saveTeamInfo() {
      for (let i = 1; i <= 4; i++) {
        const name = document.getElementById(`team-name-${i}`).value.trim();
        const topic = document.getElementById(`team-topic-${i}`).value.trim();
        if (name || topic) {
          socket.emit('admin:updateTeam', { teamId: i, name, topic });
        }
      }
      showToast('âœ… ì¡° ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤');
      document.getElementById('team-edit-panel').style.display = 'none';
    }

    // ============ ë°œí‘œ ìˆœì„œ ìˆ˜ì • ============
    let currentPresentationOrder = [2, 4, 3, 1];

    function toggleOrderEdit() {
      const panel = document.getElementById('order-edit-panel');
      if (panel.style.display === 'none' || panel.style.display === '') {
        panel.style.display = 'block';
        // í˜„ì¬ ìˆœì„œ ë¡œë“œ
        if (currentState && currentState.presentationOrder) {
          currentPresentationOrder = currentState.presentationOrder;
        }
        for (let i = 1; i <= 4; i++) {
          document.getElementById(`order-${i}`).value = currentPresentationOrder[i - 1];
        }
      } else {
        panel.style.display = 'none';
      }
    }

    function saveOrder() {
      const order = [];
      for (let i = 1; i <= 4; i++) {
        order.push(parseInt(document.getElementById(`order-${i}`).value));
      }
      // ì¤‘ë³µ ì²´í¬
      const unique = new Set(order);
      if (unique.size !== 4) {
        showToast('âš ï¸ ì¤‘ë³µëœ ì¡°ê°€ ìˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì„ íƒí•´ì£¼ì„¸ìš”.');
        return;
      }
      socket.emit('admin:updatePresentationOrder', order);
      currentPresentationOrder = order;
      updateOrderDisplay();
      showToast('âœ… ë°œí‘œ ìˆœì„œê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤');
      document.getElementById('order-edit-panel').style.display = 'none';
    }

    function updateOrderDisplay() {
      const display = document.getElementById('presentation-order-display');
      if (display && currentPresentationOrder) {
        display.textContent = currentPresentationOrder.map(id => `${id}ì¡°`).join(' â†’ ');
      }
    }

    // ë°ëª¨ í‰ê°€ì ì¶”ê°€
    function addDemoEvaluators() {
      const demoNames = ['ê¹€ëŒ€í‘œ', 'ì´ì „ë¬´', 'ë°•ìƒë¬´', 'ìµœì´ì‚¬', 'ì •ë¶€ì¥', 'í•œì°¨ì¥'];
      demoNames.forEach((name, i) => {
        setTimeout(() => {
          socket.emit('demo:addEvaluator', { name });
        }, i * 500);
      });
      showToast('ë°ëª¨ í‰ê°€ì 6ëª… ì¶”ê°€ ì¤‘...');
    }

    // ë°ëª¨ í‰ê°€ ì¶”ê°€
    function addDemoEvaluation() {
      socket.emit('demo:addEvaluation');
      showToast('ë°ëª¨ í‰ê°€ 1ê±´ ì¶”ê°€');
    }

    // ============ íŒŒí‹°í´ ìƒì„± ============
    function createParticles() {
      const container = document.getElementById('particles-container');
      for (let i = 0; i < 50; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.width = Math.random() * 10 + 5 + 'px';
        particle.style.height = particle.style.width;
        particle.style.left = Math.random() * 100 + '%';
        particle.style.top = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 15 + 's';
        particle.style.animationDuration = Math.random() * 10 + 10 + 's';
        container.appendChild(particle);
      }
    }

    // ============ QR ì½”ë“œ ìƒì„± ============
    function generateQR() {
      const url = `${window.location.origin}/mobile`;
      const qrContainer = document.getElementById('qr-code');
      qrContainer.innerHTML = '';
      new QRCode(qrContainer, {
        text: url,
        width: 250,
        height: 250,
        colorDark: '#000000',
        colorLight: '#ffffff',
        correctLevel: QRCode.CorrectLevel.H
      });
    }

    // ============ UI ë Œë”ë§ ============
    function renderTeams(teams) {
      const panel = document.getElementById('teams-panel');
      panel.innerHTML = teams.map(team => `
        <div class="team-card">
          <div class="team-number">${team.name}</div>
          <div class="team-topic">${team.topic}</div>
        </div>
      `).join('');
    }

    function renderEvaluationTeams(teams) {
      const panel = document.getElementById('evaluation-teams');
      panel.innerHTML = teams.map(team => `
        <div class="eval-team-card">
          <div class="eval-team-name">${team.name}</div>
          <div class="eval-team-topic">${team.topic}</div>
        </div>
      `).join('');
    }

    function showToast(message) {
      const container = document.getElementById('toast-container');
      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.textContent = message;
      container.appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }

    function showScreen(screenId) {
      // ê²°ê³¼ í™”ë©´ì„ ë²—ì–´ë‚  ë•Œ ì½”ì¸ ì• ë‹ˆë©”ì´ì…˜ ì •ë¦¬
      const resultsScreen = document.getElementById('results-screen');
      const header = document.querySelector('.header');
      
      if (resultsScreen.style.display !== 'none' && screenId !== 'results-screen') {
        resetCoinStacks();
      }

      document.getElementById('waiting-screen').style.display = 'none';
      document.getElementById('evaluation-screen').style.display = 'none';
      resultsScreen.style.display = 'none';
      document.getElementById('final-result').style.display = 'none';

      // ê²°ê³¼ í™”ë©´ì¼ ë•Œ í—¤ë” ì—¬ë°± ì¦ê°€ ë° subtitle ìˆ¨ê¸°ê¸°
      if (screenId === 'results-screen') {
        if (header) {
          header.style.marginBottom = '40px';
          const subtitle = header.querySelector('.subtitle');
          if (subtitle) subtitle.style.display = 'none';
        }
      } else {
        if (header) {
          header.style.marginBottom = '30px';
          const subtitle = header.querySelector('.subtitle');
          if (subtitle) subtitle.style.display = '';
        }
      }

      if (screenId) {
        document.getElementById(screenId).style.display = 'flex';
      }
    }

    // ============ ë™ì „ ë¹„ íš¨ê³¼ ============
    function startCoinRain() {
      const container = document.getElementById('coin-rain');
      container.style.display = 'block';
      container.innerHTML = '';

      const coins = ['ğŸ’°', 'ğŸ’µ', 'ğŸ’´', 'ğŸ’¶', 'ğŸ’·', 'ğŸª™', 'ğŸ’'];

      for (let i = 0; i < 100; i++) {
        setTimeout(() => {
          const coin = document.createElement('div');
          coin.className = 'coin';
          coin.textContent = coins[Math.floor(Math.random() * coins.length)];
          coin.style.left = Math.random() * 100 + '%';
          coin.style.animationDuration = Math.random() * 2 + 2 + 's';
          container.appendChild(coin);
          setTimeout(() => coin.remove(), 4000);
        }, i * 30);
      }

      setTimeout(() => container.style.display = 'none', 5000);
    }

    // ============ ì½”ì¸ ìŠ¤íƒœí‚¹ ì‹œìŠ¤í…œ (ì™„ì „ ì¬ì„¤ê³„) ============
    const COIN_CONFIG = {
      GRAVITY: 0.6,
      COIN_RADIUS: 22,
      COIN_THICKNESS: 5,
      STACK_WIDTH: 100,
      MAX_STACK_HEIGHT: 350,
      DROP_INTERVAL: 60
    };

    // ìƒíƒœ ë³€ìˆ˜
    let fallingCoins = [];
    let coinStacks = [0, 0, 0, 0]; // ê° ìˆœìœ„(0=1ìœ„, 1=2ìœ„, 2=3ìœ„, 3=4ìœ„)ë³„ ìŒ“ì¸ ì½”ì¸ ìˆ˜
    let targetStacks = [0, 0, 0, 0]; // ê° ìˆœìœ„ë³„ ëª©í‘œ ì½”ì¸ ìˆ˜
    let stackCenterX = [0, 0, 0, 0]; // ê° ìˆœìœ„ë³„ ìº”ë²„ìŠ¤ X ì¢Œí‘œ
    let highlightedRanks = [0, 1, 2, 3]; // í•˜ì´ë¼ì´íŠ¸ë˜ëŠ” ìˆœìœ„ (0=1ìœ„, 1=2ìœ„, 2=3ìœ„, 3=4ìœ„)
    let coinAnimationId = null;
    let coinCanvas = null;
    let coinCtx = null;
    let isAnimating = false;
    let canvasBaseY = 0; // ìº”ë²„ìŠ¤ ë°”ë‹¥ Y ì¢Œí‘œ
    let activeDropIntervals = []; // í™œì„± ë“œë¡­ ì¸í„°ë²Œ ì¶”ì 

    // ìº”ë²„ìŠ¤ ì´ˆê¸°í™” - DOM ìš”ì†Œ ìœ„ì¹˜ ê¸°ë°˜
    function initCoinCanvas() {
      coinCanvas = document.getElementById('coin-canvas');
      if (!coinCanvas) return;

      const container = document.getElementById('results-screen');
      const rect = container.getBoundingClientRect();

      coinCanvas.width = rect.width;
      coinCanvas.height = rect.height;
      coinCtx = coinCanvas.getContext('2d');

      // ë°”ë‹¥ Y ìœ„ì¹˜ (ìŠ¤íƒ ë² ì´ìŠ¤ ìœ„ì¹˜ ê¸°ì¤€)
      canvasBaseY = coinCanvas.height - 100;

      // ìœ„ì¹˜ ê³„ì‚° - DOM ìš”ì†Œ ê¸°ë°˜
      updateStackPositions();

      // ë¦¬ì‚¬ì´ì¦ˆ ì‹œ ì¬ê³„ì‚°
      window.addEventListener('resize', () => {
        if (coinCanvas && document.getElementById('results-screen').style.display !== 'none') {
          const newRect = container.getBoundingClientRect();
          coinCanvas.width = newRect.width;
          coinCanvas.height = newRect.height;
          canvasBaseY = coinCanvas.height - 100;
          updateStackPositions();
        }
      });
    }

    // DOM ìš”ì†Œ ê¸°ë°˜ ìŠ¤íƒ ìœ„ì¹˜ ì—…ë°ì´íŠ¸
    function updateStackPositions() {
      // rank-container ë‚´ì˜ 4ê°œ wrapper ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸°
      // í™”ë©´ ìˆœì„œ: 4ìœ„(ì™¼ìª½) - 3ìœ„ - 2ìœ„ - 1ìœ„(ì˜¤ë¥¸ìª½)
      // ë”°ë¼ì„œ wrapper ìˆœì„œ: stack-wrapper-4, stack-wrapper-3, stack-wrapper-2, stack-wrapper-1
      const container = document.getElementById('rank-container');
      if (!container) return;

      const containerRect = container.getBoundingClientRect();
      const resultsRect = document.getElementById('results-screen').getBoundingClientRect();

      // ê° ìˆœìœ„ë³„ ìŠ¤íƒ ì˜ì—­ ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸°
      for (let rank = 1; rank <= 4; rank++) {
        const wrapper = document.getElementById(`stack-wrapper-${rank}`);
        if (wrapper) {
          const wrapperRect = wrapper.getBoundingClientRect();
          // results-screen ê¸°ì¤€ ìƒëŒ€ ì¢Œí‘œë¡œ ë³€í™˜
          const centerX = wrapperRect.left - resultsRect.left + wrapperRect.width / 2;
          // stackCenterX[ìˆœìœ„-1] = í•´ë‹¹ ìˆœìœ„ì˜ X ì¢Œí‘œ
          stackCenterX[rank - 1] = centerX;
        }
      }

      console.log('Stack positions updated:', stackCenterX);
    }

    // ì½”ì¸ ê·¸ë¦¬ê¸° (ë–¨ì–´ì§€ëŠ” ì½”ì¸)
    function drawCoin(ctx, x, y, rotation) {
      ctx.save();
      ctx.translate(x, y);
      ctx.rotate(rotation);

      const radius = COIN_CONFIG.COIN_RADIUS;

      // ì½”ì¸ ê·¸ë¼ë°ì´ì…˜
      const grad = ctx.createLinearGradient(-radius, -radius, radius, radius);
      grad.addColorStop(0, '#FFD700');
      grad.addColorStop(0.3, '#FFF8DC');
      grad.addColorStop(0.5, '#FFD700');
      grad.addColorStop(0.7, '#B8860B');
      grad.addColorStop(1, '#DAA520');

      // ì½”ì¸ ì™¸ê³½
      ctx.beginPath();
      ctx.arc(0, 0, radius, 0, Math.PI * 2);
      ctx.fillStyle = grad;
      ctx.shadowBlur = 8;
      ctx.shadowColor = 'rgba(255, 215, 0, 0.5)';
      ctx.fill();

      // ë‚´ë¶€ ì›
      ctx.beginPath();
      ctx.arc(0, 0, radius * 0.75, 0, Math.PI * 2);
      ctx.strokeStyle = '#B8860B';
      ctx.lineWidth = 2;
      ctx.stroke();

      // â‚© ì‹¬ë³¼
      ctx.shadowBlur = 0;
      ctx.fillStyle = '#8B6914';
      ctx.font = `bold ${radius * 0.9}px Arial`;
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillText('â‚©', 0, 2);

      ctx.restore();
    }

    // ìŒ“ì¸ ì½”ì¸ ìŠ¤íƒ ê·¸ë¦¬ê¸° (3D ë ˆì´ì–´)
    function drawCoinStack(ctx, x, stackHeight, rankIndex) {
      const coinHeight = COIN_CONFIG.COIN_THICKNESS;
      const ellipseWidth = 55;
      const ellipseHeight = coinHeight * 1.8;

      // í•˜ì´ë¼ì´íŠ¸/Dimmed ì ìš©
      const isHighlighted = highlightedRanks.includes(rankIndex);
      const opacity = isHighlighted ? 1.0 : 0.25;

      ctx.save();
      ctx.globalAlpha = opacity;

      // Dimmed ìƒíƒœì¼ ë•Œ grayscale íš¨ê³¼ë¥¼ ìœ„í•œ ìƒ‰ìƒ ì¡°ì •
      const goldColor = isHighlighted ? '#FFD700' : '#888877';
      const midColor = isHighlighted ? '#FFC125' : '#777766';
      const darkColor = isHighlighted ? '#B8860B' : '#555544';

      for (let i = 0; i < stackHeight; i++) {
        const y = canvasBaseY - (i * coinHeight);

        // ì½”ì¸ ë ˆì´ì–´ (3D íš¨ê³¼)
        const grad = ctx.createLinearGradient(x - ellipseWidth, y - coinHeight, x + ellipseWidth, y);
        grad.addColorStop(0, goldColor);
        grad.addColorStop(0.5, midColor);
        grad.addColorStop(1, darkColor);

        ctx.beginPath();
        ctx.ellipse(x, y, ellipseWidth, ellipseHeight, 0, 0, Math.PI * 2);
        ctx.fillStyle = grad;
        ctx.fill();

        // í•˜ì´ë¼ì´íŠ¸
        ctx.beginPath();
        ctx.ellipse(x, y - 1, ellipseWidth * 0.85, coinHeight, 0, 0, Math.PI);
        ctx.fillStyle = isHighlighted ? 'rgba(255, 255, 255, 0.25)' : 'rgba(255, 255, 255, 0.1)';
        ctx.fill();
      }

      ctx.restore();
    }

    // ì½”ì¸ ì• ë‹ˆë©”ì´ì…˜ ë£¨í”„
    function animateCoins() {
      if (!coinCtx || !coinCanvas) return;

      coinCtx.clearRect(0, 0, coinCanvas.width, coinCanvas.height);

      // ìŒ“ì¸ ì½”ì¸ ìŠ¤íƒ ê·¸ë¦¬ê¸° (4ê°œ ìˆœìœ„)
      for (let rank = 0; rank < 4; rank++) {
        if (stackCenterX[rank] && coinStacks[rank] > 0) {
          drawCoinStack(coinCtx, stackCenterX[rank], coinStacks[rank], rank);
        }
      }

      // ë–¨ì–´ì§€ëŠ” ì½”ì¸ ì—…ë°ì´íŠ¸ ë° ê·¸ë¦¬ê¸°
      for (let i = fallingCoins.length - 1; i >= 0; i--) {
        const coin = fallingCoins[i];

        // ë¬¼ë¦¬ ì—…ë°ì´íŠ¸
        coin.vy += COIN_CONFIG.GRAVITY;
        coin.y += coin.vy;
        coin.x += coin.vx;
        coin.rotation += coin.rotationSpeed;

        // ì°©ì§€ ì²´í¬ - í˜„ì¬ ìŠ¤íƒ ë†’ì´ ê¸°ì¤€
        const landingY = canvasBaseY - (coinStacks[coin.rankIndex] * COIN_CONFIG.COIN_THICKNESS);

        if (coin.y >= landingY) {
          // ì½”ì¸ ì°©ì§€
          coinStacks[coin.rankIndex]++;
          fallingCoins.splice(i, 1);
        } else {
          // ì½”ì¸ ê·¸ë¦¬ê¸°
          drawCoin(coinCtx, coin.x, coin.y, coin.rotation);
        }
      }

      // ì• ë‹ˆë©”ì´ì…˜ ê³„ì† ì¡°ê±´
      coinAnimationId = requestAnimationFrame(animateCoins);
    }

    // ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
    function startCoinAnimation() {
      if (!coinAnimationId) {
        isAnimating = true;
        animateCoins();
      }
    }

    // ì• ë‹ˆë©”ì´ì…˜ ì •ì§€
    function stopCoinAnimation() {
      if (coinAnimationId) {
        cancelAnimationFrame(coinAnimationId);
        coinAnimationId = null;
      }
      isAnimating = false;

      // ëª¨ë“  í™œì„± ì¸í„°ë²Œ ì •ë¦¬
      activeDropIntervals.forEach(id => clearInterval(id));
      activeDropIntervals = [];
    }

    // ì½”ì¸ ë“œë¡­ í•¨ìˆ˜ (rankIndex: 0=1ìœ„, 1=2ìœ„, 2=3ìœ„, 3=4ìœ„)
    function dropCoin(rankIndex) {
      const x = stackCenterX[rankIndex];
      if (!x) return;

      const coin = {
        id: Date.now() + Math.random(),
        x: x + (Math.random() - 0.5) * 30,
        y: -30,
        vy: Math.random() * 2 + 1,
        vx: (Math.random() - 0.5) * 1.5,
        rotation: 0,
        rotationSpeed: (Math.random() - 0.5) * 0.2,
        rankIndex
      };

      fallingCoins.push(coin);
    }

    // íŠ¹ì • ìˆœìœ„ì— ë–¨ì–´ì§€ëŠ” ì¤‘ì¸ ì½”ì¸ ìˆ˜ ê³„ì‚°
    function getFallingCoinsCount(rankIndex) {
      return fallingCoins.filter(c => c.rankIndex === rankIndex).length;
    }

    // íŠ¹ì • ìˆœìœ„ì˜ ì´ ì½”ì¸ ìˆ˜ (ì°©ì§€ + ë–¨ì–´ì§€ëŠ” ì¤‘)
    function getTotalCoinsForRank(rankIndex) {
      return coinStacks[rankIndex] + getFallingCoinsCount(rankIndex);
    }

    // ëª©í‘œ ë†’ì´ê¹Œì§€ ì½”ì¸ ìŒ“ê¸° (ë™ì¼ ë†’ì´ ë³´ì¥ - ì ì§„ì  ì¡°ì •)
    function stackCoinsToHeight(targetHeight, duration, rankIndices, callback) {
      console.log(`stackCoinsToHeight: targetHeight=${targetHeight}, ranks=${rankIndices}`);

      const coinsNeeded = Math.floor(targetHeight / COIN_CONFIG.COIN_THICKNESS);

      // ëª©í‘œ ì„¤ì •
      rankIndices.forEach(rank => {
        targetStacks[rank] = coinsNeeded;
      });

      // ê° íŒ€ë³„ í•„ìš” ì½”ì¸ ìˆ˜ ê³„ì‚°
      let totalCoinsToAdd = 0;
      rankIndices.forEach(rank => {
        const needed = Math.max(0, coinsNeeded - coinStacks[rank]);
        totalCoinsToAdd += needed;
      });

      console.log(`Total coins to add: ${totalCoinsToAdd}, current stacks:`, coinStacks);

      if (totalCoinsToAdd === 0) {
        // ì´ë¯¸ ëª©í‘œì— ë„ë‹¬í•œ ê²½ìš° - ê°•ì œ ì¡°ì • ì—†ì´ ì½œë°±ë§Œ í˜¸ì¶œ
        if (callback) setTimeout(callback, 100);
        return;
      }

      // ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
      startCoinAnimation();

      const dropInterval = Math.max(30, duration / totalCoinsToAdd);
      let addedCount = 0;

      const intervalId = setInterval(() => {
        // ë–¨ì–´ì§€ëŠ” ì½”ì¸ê¹Œì§€ í¬í•¨í•œ ì´ ì½”ì¸ ìˆ˜ë¡œ ì²´í¬
        const needMore = rankIndices.filter(rank => getTotalCoinsForRank(rank) < targetStacks[rank]);

        if (needMore.length === 0 || addedCount >= totalCoinsToAdd) {
          clearInterval(intervalId);
          const idx = activeDropIntervals.indexOf(intervalId);
          if (idx > -1) activeDropIntervals.splice(idx, 1);

          // ëª¨ë“  ë–¨ì–´ì§€ëŠ” ì½”ì¸ì´ ì°©ì§€í•  ë•Œê¹Œì§€ ëŒ€ê¸° í›„ ì½œë°±
          waitForCoinsToLand(() => {
            if (callback) callback();
          });
          return;
        }

        // ë–¨ì–´ì§€ëŠ” ì½”ì¸ê¹Œì§€ í¬í•¨í•´ì„œ ê°€ì¥ ì ì€ ìŠ¤íƒì— ë“œë¡­ (ê· ë“± ë¶„ë°°)
        const minStack = Math.min(...needMore.map(r => getTotalCoinsForRank(r)));
        const lowestRanks = needMore.filter(r => getTotalCoinsForRank(r) === minStack);
        const rankIdx = lowestRanks[Math.floor(Math.random() * lowestRanks.length)];
        dropCoin(rankIdx);
        addedCount++;
      }, dropInterval);

      activeDropIntervals.push(intervalId);
    }

    // ëª¨ë“  ë–¨ì–´ì§€ëŠ” ì½”ì¸ì´ ì°©ì§€í•  ë•Œê¹Œì§€ ëŒ€ê¸°
    function waitForCoinsToLand(callback) {
      const checkInterval = setInterval(() => {
        if (fallingCoins.length === 0) {
          clearInterval(checkInterval);
          if (callback) callback();
        }
      }, 50);

      // ìµœëŒ€ 2ì´ˆ ëŒ€ê¸° í›„ ê°•ì œ ì§„í–‰
      setTimeout(() => {
        clearInterval(checkInterval);
        if (callback) callback();
      }, 2000);
    }

    // íŠ¹ì • íŒ€ë§Œ ì¶”ê°€ ì½”ì¸ ìŒ“ê¸°
    function addCoinsToRank(rankIndex, additionalHeight, duration, callback) {
      const additionalCoins = Math.floor(additionalHeight / COIN_CONFIG.COIN_THICKNESS);
      const newTarget = coinStacks[rankIndex] + additionalCoins;
      targetStacks[rankIndex] = newTarget;

      console.log(`addCoinsToRank: rank=${rankIndex}, additionalCoins=${additionalCoins}, newTarget=${newTarget}`);

      if (additionalCoins <= 0) {
        if (callback) setTimeout(callback, 100);
        return;
      }

      startCoinAnimation();

      const dropInterval = Math.max(40, duration / additionalCoins);
      let addedCount = 0;

      const intervalId = setInterval(() => {
        if (coinStacks[rankIndex] >= targetStacks[rankIndex] || addedCount >= additionalCoins) {
          clearInterval(intervalId);
          const idx = activeDropIntervals.indexOf(intervalId);
          if (idx > -1) activeDropIntervals.splice(idx, 1);

          setTimeout(() => {
            if (callback) callback();
          }, 600);
          return;
        }

        dropCoin(rankIndex);
        addedCount++;
      }, dropInterval);

      activeDropIntervals.push(intervalId);
    }

    // ì½”ì¸ ìŠ¤íƒ ì™„ì „ ì´ˆê¸°í™”
    function resetCoinStacks() {
      stopCoinAnimation();
      fallingCoins = [];
      coinStacks = [0, 0, 0, 0];
      targetStacks = [0, 0, 0, 0];

      if (coinCtx && coinCanvas) {
        coinCtx.clearRect(0, 0, coinCanvas.width, coinCanvas.height);
      }
    }

    // ============ ê²°ê³¼ ë°œí‘œ ============
    function renderCoinStacks(teams) {
      rankedTeams = teams;
      const container = document.getElementById('rank-container');
      const displayOrder = [3, 2, 1, 0]; // í™”ë©´ì— 4ìœ„, 3ìœ„, 2ìœ„, 1ìœ„ ìˆœì„œë¡œ í‘œì‹œ

      // ì½”ì¸ ìŠ¤íƒ ì´ˆê¸°í™”
      resetCoinStacks();

      container.innerHTML = displayOrder.map((rankIdx, displayIdx) => {
        const team = teams[rankIdx];
        const rankNum = rankIdx + 1;

        return `
          <div class="coin-stack-wrapper" id="stack-wrapper-${rankNum}">
            <div class="rank-info" id="rank-info-${rankNum}">
              <div class="rank-position">${rankNum}ìœ„</div>
              <div class="rank-team-name">${team.name}</div>
              <div class="rank-amount">${team.totalInvestment}ì–µì›</div>
            </div>
            <div class="coin-stack-area" id="stack-area-${rankNum}"
                 onclick="showFeedback(${team.id}, '${team.name}', ${team.totalInvestment})">
              <div class="stack-base"></div>
            </div>
          </div>
        `;
      }).join('');

      // ìº”ë²„ìŠ¤ ì´ˆê¸°í™” (DOM ë Œë”ë§ ì™„ë£Œ í›„)
      setTimeout(() => {
        initCoinCanvas();
      }, 100);
    }

    function handlePresentationStep(step, teams) {
      presentationStep = step;
      rankedTeams = teams;
      updateAdminUI();

      // ë‹¨ê³„ ë³€ê²½ ì‹œ í”¼ë“œë°± íŒ¨ë„ ìˆ¨ê¸°ê¸°
      hideFeedbackPanel();

      const maxInvestment = Math.max(...teams.map(t => t.totalInvestment));

      console.log(`=== Step ${step} ===`);
      console.log('Teams:', teams.map(t => `${t.name}: ${t.totalInvestment}ì–µ`));

      switch(step) {
        case 1: // ì˜¤í”„ë‹ - ëª¨ë“  ì½”ì¸ ìŠ¤íƒì´ 4ìœ„ ë†’ì´ê¹Œì§€ ëœë¤ìœ¼ë¡œ ìŒ“ì„
          showScreen('results-screen');
          renderCoinStacks(teams);
          startCoinRain();

          // ìŒ“ì´ëŠ” ì¤‘: ëª¨ë‘ í•˜ì´ë¼ì´íŠ¸
          highlightedRanks = [0, 1, 2, 3];

          // 4ìœ„ ë†’ì´ ê³„ì‚° (4ìœ„ = teams[3])
          const fourthHeight = (teams[3].totalInvestment / maxInvestment) * COIN_CONFIG.MAX_STACK_HEIGHT;
          console.log(`Step 1: 4ìœ„ ë†’ì´ = ${fourthHeight}px`);

          // DOM ë Œë”ë§ ì™„ë£Œ í›„ ìœ„ì¹˜ ì—…ë°ì´íŠ¸ ë° ì½”ì¸ ìŒ“ê¸° ì‹œì‘
          setTimeout(() => {
            updateStackPositions();
            // ëª¨ë“  íŒ€(0=1ìœ„, 1=2ìœ„, 2=3ìœ„, 3=4ìœ„)ì´ 4ìœ„ ë†’ì´ê¹Œì§€ ìŒ“ê¸°
            stackCoinsToHeight(fourthHeight, 8000, [0, 1, 2, 3]);
          }, 300);
          break;

        case 2: // 4ìœ„ í•˜ì´ë¼ì´íŠ¸ (ëª¨ë‘ ê°™ì€ ë†’ì´ì—ì„œ 4ìœ„ ê³µê°œ)
          // 4ìœ„(index 3)ë§Œ í•˜ì´ë¼ì´íŠ¸, ë‚˜ë¨¸ì§€ dimmed
          highlightedRanks = [3];
          highlightStack(4, teams);
          break;

        case 3: // 3ìœ„ ë°œí‘œ: 1,2,3ìœ„ ì½”ì¸ì´ ëœë¤ìœ¼ë¡œ ìŒ“ì´ë‹¤ê°€ 3ìœ„ ë†’ì´ì—ì„œ ê°™ì•„ì§
          // ìŒ“ì´ëŠ” ì¤‘: 1,2,3ìœ„ í•˜ì´ë¼ì´íŠ¸ (index 0,1,2)
          highlightedRanks = [0, 1, 2];
          animateToThirdPlace(teams);
          break;

        case 4: // ë°ë“œíˆíŠ¸: 1,2ìœ„ ì½”ì¸ì´ ëœë¤ìœ¼ë¡œ ìŒ“ì´ë‹¤ê°€ 2ìœ„ ë†’ì´ì—ì„œ ê°™ì•„ì§
          // ìŒ“ì´ëŠ” ì¤‘: 1,2ìœ„ í•˜ì´ë¼ì´íŠ¸ (index 0,1)
          highlightedRanks = [0, 1];
          animateToDeadheat(teams);
          break;

        case 5: // 1ìœ„ë§Œ ì½”ì¸ ìƒìŠ¹ + ì ìˆ˜ ê³µê°œ
          // 1ìœ„ë§Œ í•˜ì´ë¼ì´íŠ¸ (index 0)
          highlightedRanks = [0];
          revealFirstPlace(teams);
          break;

        case 6: // 1ìœ„ í•˜ì´ë¼ì´íŠ¸
          // 1ìœ„ë§Œ í•˜ì´ë¼ì´íŠ¸
          highlightedRanks = [0];
          highlightWinner(teams);
          break;

        case 7: // ìµœì¢… ê²°ê³¼ í™”ë©´
          showFinalResult(teams[0], teams[1]);
          break;
      }
    }

    // íŠ¹ì • ìˆœìœ„ í•˜ì´ë¼ì´íŠ¸
    function highlightStack(rank, teams) {
      // ëª¨ë“  ìŠ¤íƒ dimmed
      for (let i = 1; i <= 4; i++) {
        const area = document.getElementById(`stack-area-${i}`);
        if (area) {
          area.classList.remove('highlighted');
          area.classList.add('dimmed');
        }
      }

      // í•´ë‹¹ ìˆœìœ„ë§Œ í•˜ì´ë¼ì´íŠ¸
      const area = document.getElementById(`stack-area-${rank}`);
      const info = document.getElementById(`rank-info-${rank}`);

      if (area) {
        area.classList.remove('dimmed');
        area.classList.add('highlighted');
      }

      if (info) {
        setTimeout(() => {
          info.classList.add('visible', 'revealed');
        }, 1000);
      }
    }

    // 3ìœ„ ë°œí‘œ ì• ë‹ˆë©”ì´ì…˜
    function animateToThirdPlace(teams) {
      const maxInvestment = Math.max(...teams.map(t => t.totalInvestment));
      const thirdHeight = (teams[2].totalInvestment / maxInvestment) * COIN_CONFIG.MAX_STACK_HEIGHT;

      console.log(`Step 3: 3ìœ„ ë†’ì´ = ${thirdHeight}px, í˜„ì¬ ìŠ¤íƒ:`, coinStacks);

      // 4ìœ„ dimmed
      const area4 = document.getElementById('stack-area-4');
      if (area4) {
        area4.classList.add('dimmed');
        area4.classList.remove('highlighted');
      }

      // 1,2,3ìœ„ í•˜ì´ë¼ì´íŠ¸
      for (let i = 1; i <= 3; i++) {
        const area = document.getElementById(`stack-area-${i}`);
        if (area) {
          area.classList.remove('dimmed');
          area.classList.add('highlighted');
        }
      }

      // ì½”ì¸ì„ 3ìœ„ ë†’ì´ê¹Œì§€ ìŒ“ê¸° (1ìœ„=0, 2ìœ„=1, 3ìœ„=2)
      stackCoinsToHeight(thirdHeight, 5000, [0, 1, 2], () => {
        // 3ìœ„ë§Œ í•˜ì´ë¼ì´íŠ¸ (Canvasìš©)
        highlightedRanks = [2];
        // 3ìœ„ í•˜ì´ë¼ì´íŠ¸
        setTimeout(() => {
          highlightStack(3, teams);
          // 4ìœ„ ì •ë³´ë„ í‘œì‹œ
          const info4 = document.getElementById('rank-info-4');
          if (info4) info4.classList.add('visible');
        }, 500);
      });
    }

    // ë°ë“œíˆíŠ¸ ì• ë‹ˆë©”ì´ì…˜ (1,2ìœ„ê°€ ê°™ì€ ë†’ì´ê¹Œì§€)
    function animateToDeadheat(teams) {
      const maxInvestment = Math.max(...teams.map(t => t.totalInvestment));
      const secondHeight = (teams[1].totalInvestment / maxInvestment) * COIN_CONFIG.MAX_STACK_HEIGHT;

      console.log(`Step 4: 2ìœ„ ë†’ì´ = ${secondHeight}px, í˜„ì¬ ìŠ¤íƒ:`, coinStacks);

      // 3,4ìœ„ dimmed
      for (let i = 3; i <= 4; i++) {
        const area = document.getElementById(`stack-area-${i}`);
        const info = document.getElementById(`rank-info-${i}`);
        if (area) {
          area.classList.add('dimmed');
          area.classList.remove('highlighted');
        }
        if (info) info.classList.add('visible');
      }

      // 1,2ìœ„ í•˜ì´ë¼ì´íŠ¸
      for (let i = 1; i <= 2; i++) {
        const area = document.getElementById(`stack-area-${i}`);
        const info = document.getElementById(`rank-info-${i}`);
        if (area) {
          area.classList.remove('dimmed');
          area.classList.add('highlighted');
        }
        if (info) {
          info.classList.remove('visible', 'revealed');
        }
      }

      // ì½”ì¸ì„ 2ìœ„ ë†’ì´ê¹Œì§€ ìŒ“ê¸° (1ìœ„=0, 2ìœ„=1)
      stackCoinsToHeight(secondHeight, 5000, [0, 1], () => {
        // ë°ë“œíˆíŠ¸ - 1,2ìœ„ ëª¨ë‘ í•˜ì´ë¼ì´íŠ¸ ìœ ì§€
        highlightedRanks = [0, 1];
        // ë°ë“œíˆíŠ¸ ì˜¤ë²„ë ˆì´ í‘œì‹œ
        setTimeout(() => {
          document.getElementById('deadheat-amount').textContent = `${teams[1].totalInvestment}ì–µì›`;
          document.getElementById('deadheat-team1').textContent = teams[0].name;
          document.getElementById('deadheat-team2').textContent = teams[1].name;
          document.getElementById('deadheat-overlay').style.display = 'flex';
        }, 800);
      });
    }

    // 1ìœ„ ì ìˆ˜ ê³µê°œ (1ìœ„ë§Œ ì½”ì¸ ì¶”ê°€)
    function revealFirstPlace(teams) {
      document.getElementById('deadheat-overlay').style.display = 'none';

      const maxInvestment = Math.max(...teams.map(t => t.totalInvestment));
      const firstHeight = (teams[0].totalInvestment / maxInvestment) * COIN_CONFIG.MAX_STACK_HEIGHT;
      const secondHeight = (teams[1].totalInvestment / maxInvestment) * COIN_CONFIG.MAX_STACK_HEIGHT;

      // 1ìœ„ê°€ ì¶”ê°€í•´ì•¼ í•  ë†’ì´ (í˜„ì¬ 2ìœ„ ë†’ì´ì—ì„œ 1ìœ„ ë†’ì´ê¹Œì§€)
      const additionalHeight = firstHeight - secondHeight;

      console.log(`Step 5: 1ìœ„ ë†’ì´ = ${firstHeight}px, ì¶”ê°€ ë†’ì´ = ${additionalHeight}px, í˜„ì¬ ìŠ¤íƒ:`, coinStacks);

      // 3,4ìœ„ ì •ë³´ í‘œì‹œ
      for (let i = 3; i <= 4; i++) {
        const info = document.getElementById(`rank-info-${i}`);
        if (info) info.classList.add('visible');
      }

      // 1ìœ„ë§Œ í•˜ì´ë¼ì´íŠ¸ (Canvasìš©) - 2ìœ„ëŠ” dimmed
      highlightedRanks = [0];

      // 1ìœ„ë§Œ DOM í•˜ì´ë¼ì´íŠ¸, 2ìœ„ëŠ” dimmed
      const area1 = document.getElementById('stack-area-1');
      const area2 = document.getElementById('stack-area-2');
      if (area1) {
        area1.classList.remove('dimmed');
        area1.classList.add('highlighted');
      }
      if (area2) {
        area2.classList.remove('highlighted');
        area2.classList.add('dimmed');
      }

      // 1ìœ„ë§Œ ì¶”ê°€ ì½”ì¸ (1ìœ„=0)
      addCoinsToRank(0, additionalHeight, 4000, () => {
        // 1ìœ„, 2ìœ„ ì •ë³´ í‘œì‹œ
        setTimeout(() => {
          const info1 = document.getElementById('rank-info-1');
          const info2 = document.getElementById('rank-info-2');
          if (info1) info1.classList.add('visible', 'revealed');
          if (info2) info2.classList.add('visible', 'revealed');
        }, 500);
      });
    }

    // 1ìœ„ í•˜ì´ë¼ì´íŠ¸
    function highlightWinner(teams) {
      // 1ìœ„ë§Œ í•˜ì´ë¼ì´íŠ¸, ë‚˜ë¨¸ì§€ dimmed
      for (let i = 2; i <= 4; i++) {
        const area = document.getElementById(`stack-area-${i}`);
        if (area) {
          area.classList.remove('highlighted');
          area.classList.add('dimmed');
        }
      }

      const area1 = document.getElementById('stack-area-1');
      if (area1) {
        area1.classList.add('highlighted');
        area1.classList.remove('dimmed');
      }

      startCoinRain();
    }


    function showFinalResult(winner, second) {
      document.getElementById('deadheat-overlay').style.display = 'none';

      // ê²°ê³¼ í™”ë©´ ìˆ¨ê¸°ê¸°
      document.getElementById('results-screen').style.display = 'none';

      // ìµœì¢… ê²°ê³¼ í™”ë©´ í‘œì‹œ
      setTimeout(() => {
        document.getElementById('winner-name').textContent = winner.name;
        document.getElementById('winner-amount').textContent = `ì´ ${winner.totalInvestment}ì–µì› íˆ¬ì ìœ ì¹˜!`;
        document.getElementById('winner-diff').textContent = `2ìœ„ì™€ì˜ ì°¨ì´: ${winner.totalInvestment - second.totalInvestment}ì–µì›`;

        // íˆ¬ì ë‚´ì—­ í‘œì‹œ (ë²„íŠ¼ìœ¼ë¡œ ë³€ê²½)
        const investmentDetails = document.getElementById('winner-investment-details');
        if (winner.investments && winner.investments.length > 0) {
          investmentDetails.innerHTML = `
            <div class="winner-investment-title">ğŸ’° íˆ¬ì ë‚´ì—­</div>
            <div class="winner-investment-list">
              ${winner.investments.map(inv => `
                <div class="winner-investment-item">
                  <span class="investor-name">${inv.evaluator || 'ìµëª…'}</span>
                  <span class="investment-amount">${inv.amount || inv.investment || 0}ì–µì›</span>
                </div>
              `).join('')}
            </div>
            <div style="text-align: center; margin-top: 20px; font-size: 0.9rem; color: #ffd700; opacity: 0.8;">
              ğŸ‘† í´ë¦­í•˜ì—¬ ë§ˆì§€ë§‰ í˜ì´ì§€ë¡œ ì´ë™
            </div>
          `;
        } else {
          // investmentsê°€ ì—†ìœ¼ë©´ evaluationsì—ì„œ ê³„ì‚°
          const evaluations = winner.evaluations || [];
          if (evaluations.length > 0) {
            investmentDetails.innerHTML = `
              <div class="winner-investment-title">ğŸ’° íˆ¬ì ë‚´ì—­</div>
              <div class="winner-investment-list">
                ${evaluations.map(eval => `
                  <div class="winner-investment-item">
                    <span class="investor-name">${eval.evaluator || 'ìµëª…'}</span>
                    <span class="investment-amount">${eval.investment || eval.amount || 0}ì–µì›</span>
                  </div>
                `).join('')}
              </div>
              <div style="text-align: center; margin-top: 20px; font-size: 0.9rem; color: #ffd700; opacity: 0.8;">
                ğŸ‘† í´ë¦­í•˜ì—¬ ë§ˆì§€ë§‰ í˜ì´ì§€ë¡œ ì´ë™
              </div>
            `;
          } else {
            investmentDetails.innerHTML = `
              <div class="winner-investment-title">ğŸ’° íˆ¬ì ë‚´ì—­</div>
              <div style="text-align: center; margin-top: 20px; font-size: 0.9rem; color: #ffd700; opacity: 0.8;">
                ğŸ‘† í´ë¦­í•˜ì—¬ ë§ˆì§€ë§‰ í˜ì´ì§€ë¡œ ì´ë™
              </div>
            `;
          }
        }

        const feedbackList = document.getElementById('winner-feedback-list');
        // 1ìœ„ì˜ ëª¨ë“  í”¼ë“œë°± í‘œì‹œ
        const winnerFeedbacks = winner.feedbacks || [];
        feedbackList.innerHTML = winnerFeedbacks.length > 0 ? winnerFeedbacks.map(fb => `
          <div class="winner-feedback-item">
            <div class="feedback-author">${fb.evaluator}</div>
            <div class="feedback-content">${fb.content}</div>
          </div>
        `).join('') : '<div class="winner-feedback-item">í”¼ë“œë°±ì´ ì—†ìŠµë‹ˆë‹¤.</div>';

        document.getElementById('final-result').style.display = 'flex';
        startCoinRain();
      }, 500);
    }

    let currentFeedbackTeamId = null;

    function showFeedback(teamId, teamName, amount) {
      const feedbackOverlay = document.getElementById('feedback-overlay');
      const feedbackPanel = document.getElementById('feedback-panel');

      // ê°™ì€ ë§‰ëŒ€ë¥¼ ë‹¤ì‹œ í´ë¦­í•˜ë©´ íŒ¨ë„ ë‹«ê¸°
      if (currentFeedbackTeamId === teamId && feedbackOverlay.classList.contains('show')) {
        hideFeedbackPanel();
        return;
      }

      const team = currentState.teams.find(t => t.id === teamId);
      if (!team || !team.feedbacks || !team.feedbacks.length) {
        showToast('í”¼ë“œë°±ì´ ì—†ìŠµë‹ˆë‹¤');
        return;
      }

      currentFeedbackTeamId = teamId;
      document.getElementById('popup-team-name').textContent = teamName;
      document.getElementById('popup-amount').textContent = `ì´ íˆ¬ì ìœ ì¹˜: ${amount}ì–µì›`;
      document.getElementById('feedback-list').innerHTML = team.feedbacks.map(fb => `
        <div class="feedback-item">
          <div class="feedback-author">${fb.evaluator}</div>
          <div class="feedback-content">${fb.content}</div>
        </div>
      `).join('');
      feedbackOverlay.classList.add('show');
      feedbackPanel.classList.add('show');
    }

    function hideFeedbackPanel(event) {
      document.getElementById('feedback-overlay').classList.remove('show');
      document.getElementById('feedback-panel').classList.remove('show');
      currentFeedbackTeamId = null;
    }

    // ë§ˆì§€ë§‰ ì¶•í•˜ í˜ì´ì§€ í‘œì‹œ
    function showClosingScreen() {
      document.getElementById('final-result').style.display = 'none';
      document.getElementById('closing-screen').classList.add('show');
      startCoinRain();
    }

    // ============ Socket ì´ë²¤íŠ¸ ============
    socket.emit('display:join');

    socket.on('state:update', (state) => {
      currentState = state;

      document.getElementById('connected-count').textContent = state.connectedCount;
      document.getElementById('eval-count').textContent = state.evaluatedCount;
      document.getElementById('total-evaluators').textContent = state.totalEvaluators;

      const progress = (state.evaluatedCount / state.totalEvaluators) * 100;
      document.getElementById('progress-bar').style.width = progress + '%';

      // ë°œí‘œ ìˆœì„œ ì—…ë°ì´íŠ¸
      if (state.presentationOrder) {
        currentPresentationOrder = state.presentationOrder;
        updateOrderDisplay();
      }

      renderTeams(state.teams);
      updateAdminUI();

      if (state.phase === 'waiting') {
        showScreen('waiting-screen');
      } else if (state.phase === 'evaluating') {
        showScreen('evaluation-screen');
        renderEvaluationTeams(state.teams);
      } else if (state.phase === 'results') {
        showScreen('evaluation-screen');
      } else if (state.phase === 'presenting') {
        showScreen('results-screen');
      }
    });

    socket.on('evaluator:connected', ({ name, count }) => {
      showToast(`âœ… ${name}ë‹˜ ì ‘ì† ì™„ë£Œ!`);
      const list = document.getElementById('connection-list');
      list.innerHTML += `<span class="connection-item">${name}</span>`;
    });

    socket.on('evaluator:reconnected', ({ name }) => {
      showToast(`ğŸ”„ ${name}ë‹˜ ì¬ì ‘ì†!`);
    });

    socket.on('evaluation:completed', ({ name, evaluatedCount, totalEvaluators }) => {
      showToast(`ğŸ“ ${name}ë‹˜ í‰ê°€ ì™„ë£Œ! (${evaluatedCount}/${totalEvaluators})`);
      const remaining = totalEvaluators - evaluatedCount;
      document.getElementById('progress-detail').textContent =
        remaining > 0 ? `${remaining}ëª… í‰ê°€ ì¤‘...` : 'ëª¨ë“  í‰ê°€ ì™„ë£Œ!';
    });

    socket.on('evaluation:allComplete', () => {
      document.getElementById('progress-detail').textContent = 'ğŸ‰ ëª¨ë“  í‰ê°€ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!';
      document.getElementById('start-presentation-btn').classList.add('show');
      showToast('ëª¨ë“  í‰ê°€ ì™„ë£Œ! ê²°ê³¼ ë°œí‘œë¥¼ ì‹œì‘í•˜ì„¸ìš”');
    });

    socket.on('presentation:step', ({ step, rankedTeams: teams }) => {
      handlePresentationStep(step, teams);
    });

    socket.on('system:reset', () => {
      location.reload();
    });

    // ============ í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ============
    document.addEventListener('keydown', (e) => {
      if (currentState?.phase === 'presenting') {
        if (e.key === ' ' || e.key === 'ArrowRight' || e.key === 'Enter') {
          e.preventDefault();
          nextStep();
        }
      }
    });

    // ============ ì´ˆê¸°í™” ============
    createParticles();
    generateQR();
  </script>
</body>
</html>
